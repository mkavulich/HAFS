#
# The defaults that cover a majority of our workflow tasks
#
rocoto:
  entities:
    ACCOUNT: '{{ user.ACCOUNT }}'
    VAR_DEFNS_FP: '{{ workflow.VAR_DEFNS_FP }}'
    HOMEdir: '{{ user.HOMEdir }}'
    LOAD_MODULES_RUN_TASK_FP: '{{ workflow.LOAD_MODULES_RUN_TASK_FP }}'
    NCORES_PER_NODE: '{{ platform.NCORES_PER_NODE }}'
    PARTITION_DEFAULT: '{{ platform.get("PARTITION_DEFAULT") }}'
    QUEUE_DEFAULT: '{{ platform.get("QUEUE_DEFAULT") }}'
    SCRIPTSdir: '{{ user.SCRIPTSdir }}'
    USHdir: '{{ user.USHdir }}'
    WORKFLOW_ID: '{{ workflow.WORKFLOW_ID }}'

    FCST_DIR: '{{ workflow.EXPTDIR }}/@Y@m@d@H'
    LOGDIR: '{{ workflow.EXPTDIR }}/log'
    LOGEXT: ".log"
  attrs:
    cyclethrottle: "100"
    realtime: "F"
    scheduler: '{{ platform.SCHED }}'
    taskthrottle: "100"
  cycledefs:
    at_start:
      - !startstopfreq ['{{hafs.DATE_FIRST_CYCL}}', '{{hafs.DATE_FIRST_CYCL}}', '{{hafs.INCR_CYCL_FREQ}}']
    forecast:
      - !startstopfreq ['{{hafs.DATE_FIRST_CYCL}}', '{{hafs.DATE_LAST_CYCL}}', '{{hafs.INCR_CYCL_FREQ}}']
    cycled_from_second:
      - !startstopfreq ['{%- if hafs.DATE_FIRST_CYCL != hafs.DATE_LAST_CYCL %}{{ [hafs.DATE_FIRST_CYCL[0:8], "{:02d}".format(hafs.INCR_CYCL_FREQ)]|join }}{%- else %}{{hafs.DATE_FIRST_CYCL}}{%- endif %}', '{{hafs.DATE_LAST_CYCL}}', '{{hafs.INCR_CYCL_FREQ}}']
  log: !cycstr '&LOGDIR;/hafs_vx_wflow.log'
  tasks:
    taskgroups: '{{ ["parm/wflow/verify_pre.yaml"]|include }}'

